[2020-02-29 13:15:15,057|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:15,081|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 13:15:15,089|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:15:15,091|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:15,095|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:15,113|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 13:15:15,142|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 13:15:15,146|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 13:15:15,149|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 13:15:15,152|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 13:15:15,155|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 13:15:15,157|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:15,162|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:15,180|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 13:15:15,186|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 13:15:17,428|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 13:15:17,463|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:15:17,464|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:17,477|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:17,498|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 13:15:17,535|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:15:17,537|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:17,542|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:17,560|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 13:15:17,562|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 13:15:17,961|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 13:15:18,006|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 13:15:18,009|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 13:15:18,010|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 13:15:18,458|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 13:15:18,509|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 13:15:18,516|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 13:15:18,522|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 13:15:18,523|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:18,537|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:18,556|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 13:15:18,573|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 13:15:18,583|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 13:15:18,599|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 13:15:18,602|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:18,605|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:18,620|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 13:15:18,624|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:15:18,625|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:18,627|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:18,643|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 13:15:18,649|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:15:18,651|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:18,655|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:18,672|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 13:15:18,733|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:15:18,735|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:18,771|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:18,808|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 13:15:18,856|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 13:15:18,887|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 13:15:18,931|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 13:15:18,933|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:15:18,954|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 13:15:18,974|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 13:15:18,984|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:15:18,985|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:17:57,460|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 13:17:57,474|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 13:17:57,482|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 13:17:57,484|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:17:57,487|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 13:17:57,499|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 13:17:57,523|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 13:17:57,525|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 13:17:57,528|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 13:17:57,531|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 13:17:57,532|causallift.nodes.estimate_propensity|INFO] Skip estimation of propensity score because Propensity column found in the data frame. 
[2020-02-29 13:17:57,534|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 13:17:57,535|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 13:17:57,539|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 13:17:57,540|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 14:54:25,745|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:25,758|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 14:54:25,767|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:54:25,768|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:25,773|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:25,787|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 14:54:25,808|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 14:54:25,811|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 14:54:25,814|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 14:54:25,817|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 14:54:25,819|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 14:54:25,820|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:25,823|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:25,840|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 14:54:25,845|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 14:54:25,847|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 14:54:28,315|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 14:54:28,317|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 14:54:28,353|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:54:28,354|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:28,364|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:28,378|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 14:54:28,390|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 14:54:28,639|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 14:54:28,669|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 14:54:28,681|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 14:54:28,705|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:54:28,707|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:28,710|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 14:54:28,712|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 14:54:28,716|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:28,734|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 14:54:28,735|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 14:54:29,038|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 14:54:29,053|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 14:54:29,099|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 14:54:29,126|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 14:54:29,130|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 14:54:29,131|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 14:54:29,331|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 14:54:29,346|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 14:54:29,390|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 14:54:29,414|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 14:54:29,424|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 14:54:29,430|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 14:54:29,432|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:29,447|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:29,468|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 14:54:29,485|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 14:54:29,492|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 14:54:29,511|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 14:54:29,512|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:29,515|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:29,530|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 14:54:29,533|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:54:29,535|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:29,539|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:29,557|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 14:54:29,562|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:54:29,564|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:29,568|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:29,585|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 14:54:29,647|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:54:29,649|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:29,685|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:29,726|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 14:54:29,763|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 14:54:29,786|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 14:54:29,811|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 14:54:29,849|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 14:54:29,870|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 14:54:29,872|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:29,889|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 14:54:29,908|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 14:54:29,918|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:54:29,919|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:54:29,929|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 14:54:29,939|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 14:56:04,733|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:04,748|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 14:56:04,756|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:56:04,757|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:04,761|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:04,777|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 14:56:04,800|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 14:56:04,803|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 14:56:04,806|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 14:56:04,809|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 14:56:04,812|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 14:56:04,813|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:04,817|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:04,829|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 14:56:04,835|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 14:56:04,837|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 14:56:04,958|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 14:56:04,959|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 14:56:04,984|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:56:04,985|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:04,996|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:05,010|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 14:56:05,021|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 14:56:05,279|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 14:56:05,315|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 14:56:05,325|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 14:56:05,347|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:56:05,349|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:05,354|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 14:56:05,356|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 14:56:05,360|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:05,380|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 14:56:05,381|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 14:56:05,651|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 14:56:05,672|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 14:56:05,710|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 14:56:05,732|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 14:56:05,735|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 14:56:05,738|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 14:56:05,951|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 14:56:05,967|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 14:56:06,010|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 14:56:06,030|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 14:56:06,039|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 14:56:06,044|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 14:56:06,046|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:06,057|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:06,080|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 14:56:06,101|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 14:56:06,109|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 14:56:06,123|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 14:56:06,124|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:06,127|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:06,139|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 14:56:06,142|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:56:06,143|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:06,146|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:06,158|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 14:56:06,163|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:56:06,164|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:06,169|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:06,183|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 14:56:06,234|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:56:06,235|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:06,264|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:06,295|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 14:56:06,330|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 14:56:06,350|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 14:56:06,377|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 14:56:06,410|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 14:56:06,431|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 14:56:06,432|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:06,442|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 14:56:06,462|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 14:56:06,472|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:56:06,474|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:56:06,480|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 14:56:06,490|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 14:59:39,259|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:39,273|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 14:59:39,280|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:59:39,282|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:39,287|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:39,301|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 14:59:39,303|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 14:59:39,306|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 14:59:39,330|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 14:59:39,333|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 14:59:39,336|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 14:59:39,337|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:39,344|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:39,360|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 14:59:39,366|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 14:59:39,368|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 14:59:41,867|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 14:59:41,869|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 14:59:41,899|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:59:41,901|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:41,910|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:41,924|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 14:59:41,934|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 14:59:42,222|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 14:59:42,257|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 14:59:42,270|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 14:59:42,296|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:59:42,297|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:42,300|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 14:59:42,301|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 14:59:42,305|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:42,326|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 14:59:42,327|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 14:59:42,556|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 14:59:42,577|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 14:59:42,613|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 14:59:42,629|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 14:59:42,632|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 14:59:42,633|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 14:59:42,904|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 14:59:42,921|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 14:59:42,966|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 14:59:42,982|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 14:59:42,991|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 14:59:42,996|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 14:59:42,998|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:43,013|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:43,032|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 14:59:43,048|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 14:59:43,055|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 14:59:43,074|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 14:59:43,075|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:43,079|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:43,095|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 14:59:43,099|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:59:43,100|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:43,103|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:43,118|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 14:59:43,123|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:59:43,125|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:43,131|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:43,145|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 14:59:43,205|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:59:43,206|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:43,235|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:43,269|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 14:59:43,310|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 14:59:43,335|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 14:59:43,369|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 14:59:43,415|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 14:59:43,445|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 14:59:43,447|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:43,457|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 14:59:43,475|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 14:59:43,485|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 14:59:43,487|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 14:59:43,494|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 14:59:43,507|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 16:53:48,685|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:48,701|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 16:53:48,711|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 16:53:48,713|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:48,716|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:48,734|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 16:53:48,757|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 16:53:48,760|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 16:53:48,763|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 16:53:48,765|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 16:53:48,768|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 16:53:48,770|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:48,776|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:48,792|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 16:53:48,797|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 16:53:48,799|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 16:53:51,420|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 16:53:51,422|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 16:53:51,455|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 16:53:51,457|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:51,466|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:51,480|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 16:53:51,492|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 16:53:51,776|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 16:53:51,808|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 16:53:51,816|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 16:53:51,840|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 16:53:51,842|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:51,845|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 16:53:51,846|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 16:53:51,850|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:51,868|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 16:53:51,869|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 16:53:52,107|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 16:53:52,129|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 16:53:52,166|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 16:53:52,183|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 16:53:52,186|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 16:53:52,187|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 16:53:52,437|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 16:53:52,458|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 16:53:52,499|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 16:53:52,517|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 16:53:52,524|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 16:53:52,529|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 16:53:52,530|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:52,544|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:52,565|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 16:53:52,579|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 16:53:52,589|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 16:53:52,609|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 16:53:52,610|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:52,613|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:52,624|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 16:53:52,627|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 16:53:52,628|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:52,630|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:52,644|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 16:53:52,649|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 16:53:52,650|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:52,657|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:52,671|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 16:53:52,733|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 16:53:52,735|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:52,764|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:52,796|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 16:53:52,832|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 16:53:52,853|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 16:53:52,876|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 16:53:52,913|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 16:53:52,938|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 16:53:52,939|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:52,958|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 16:53:52,979|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 16:53:52,986|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 16:53:52,988|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 16:53:52,996|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 16:53:53,006|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 16:54:11,376|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 16:54:15,010|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 16:54:15,015|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 16:54:15,021|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 16:54:15,026|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 16:54:15,031|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:26:09,479|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:09,498|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 17:26:09,508|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:26:09,509|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:09,514|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:09,526|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 17:26:09,553|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:26:09,556|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 17:26:09,558|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:26:09,562|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 17:26:09,565|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:26:09,567|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:09,570|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:09,587|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 17:26:09,593|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 17:26:09,594|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 17:26:11,915|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 17:26:11,917|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 17:26:11,951|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:26:11,953|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:11,963|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:11,978|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 17:26:11,993|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 17:26:12,273|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 17:26:12,303|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 17:26:12,314|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 17:26:12,336|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:26:12,337|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:12,340|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 17:26:12,341|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 17:26:12,345|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:12,365|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 17:26:12,367|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 17:26:12,595|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:26:12,610|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:26:12,648|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:26:12,665|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:26:12,669|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 17:26:12,671|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 17:26:12,958|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:26:12,971|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:26:13,012|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:26:13,031|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:26:13,041|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 17:26:13,046|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:26:13,048|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:13,061|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:13,081|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 17:26:13,096|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:26:13,104|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 17:26:13,120|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:26:13,121|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:13,125|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:13,137|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 17:26:13,140|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:26:13,142|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:13,145|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:13,162|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 17:26:13,166|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:26:13,168|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:13,173|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:13,187|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 17:26:13,246|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:26:13,247|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:13,288|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:13,326|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 17:26:13,372|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 17:26:13,397|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:26:13,421|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 17:26:13,458|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 17:26:13,484|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:26:13,486|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:13,506|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 17:26:13,530|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 17:26:13,543|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:26:13,545|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:26:13,556|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 17:26:13,568|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 17:26:31,946|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:26:35,642|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:26:35,646|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:26:35,651|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:26:35,657|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:26:35,663|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:43:12,836|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:12,851|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 17:43:12,858|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:12,859|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:12,863|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:12,882|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 17:43:12,905|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:43:12,908|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 17:43:12,910|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:43:12,913|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 17:43:12,916|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:43:12,917|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:12,921|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:12,937|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 17:43:12,943|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 17:43:12,944|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 17:43:15,054|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 17:43:15,055|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 17:43:15,081|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:15,082|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:15,091|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:15,104|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 17:43:15,115|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 17:43:15,384|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 17:43:15,410|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 17:43:15,419|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 17:43:15,440|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:15,441|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:15,445|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 17:43:15,446|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 17:43:15,450|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:15,464|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 17:43:15,466|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 17:43:15,742|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:43:15,756|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:43:15,795|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:43:15,812|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:43:15,816|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 17:43:15,817|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 17:43:16,002|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:43:16,016|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:43:16,058|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:43:16,076|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:43:16,085|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 17:43:16,089|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:43:16,091|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:16,103|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:16,119|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 17:43:16,134|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:43:16,140|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 17:43:16,155|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:43:16,156|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:16,159|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:16,173|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 17:43:16,176|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:16,177|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:16,180|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:16,193|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 17:43:16,198|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:16,199|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:16,204|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:16,221|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 17:43:16,271|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:16,272|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:16,316|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:16,352|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 17:43:16,382|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 17:43:16,406|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:43:16,442|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 17:43:16,481|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 17:43:16,501|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:43:16,503|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:16,520|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:16,540|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 17:43:16,551|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:16,552|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:16,561|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 17:43:16,569|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 17:43:48,488|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:48,501|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 17:43:48,509|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:48,511|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:48,515|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:48,532|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 17:43:48,554|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:43:48,557|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 17:43:48,560|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:43:48,564|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 17:43:48,567|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:43:48,569|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:48,572|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:48,585|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 17:43:48,592|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 17:43:48,593|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 17:43:50,694|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 17:43:50,696|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 17:43:50,728|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:50,729|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:50,738|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:50,750|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 17:43:50,764|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 17:43:51,036|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 17:43:51,065|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 17:43:51,074|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 17:43:51,099|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:51,100|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:51,103|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 17:43:51,105|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 17:43:51,109|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:51,124|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 17:43:51,125|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 17:43:51,398|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:43:51,415|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:43:51,462|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:43:51,477|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:43:51,479|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 17:43:51,481|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 17:43:51,660|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:43:51,675|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:43:51,734|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:43:51,751|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:43:51,758|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 17:43:51,763|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:43:51,764|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:51,777|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:51,800|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 17:43:51,817|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:43:51,824|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 17:43:51,838|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:43:51,840|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:51,843|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:51,855|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 17:43:51,859|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:51,860|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:51,862|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:51,875|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 17:43:51,880|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:51,881|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:51,885|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:51,901|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 17:43:51,955|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:51,956|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:51,984|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:52,017|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 17:43:52,049|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 17:43:52,067|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:43:52,092|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 17:43:52,122|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 17:43:52,143|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:43:52,144|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:52,156|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 17:43:52,173|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 17:43:52,184|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:43:52,185|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:43:52,194|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 17:43:52,202|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 17:44:10,578|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:44:14,357|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:44:14,361|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:44:14,367|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:44:14,373|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:44:14,378|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:56:23,518|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:23,531|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 17:56:23,540|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:56:23,542|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:23,545|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:23,559|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 17:56:23,582|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:56:23,585|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 17:56:23,588|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:56:23,593|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 17:56:23,596|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:56:23,598|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:23,601|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:23,619|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 17:56:23,627|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 17:56:23,628|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 17:56:25,816|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 17:56:25,818|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 17:56:25,853|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:56:25,854|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:25,864|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:25,877|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 17:56:25,890|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 17:56:26,163|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 17:56:26,195|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 17:56:26,205|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 17:56:26,228|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:56:26,229|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:26,232|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 17:56:26,234|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 17:56:26,237|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:26,252|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 17:56:26,253|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 17:56:26,521|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:56:26,535|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:56:26,579|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:56:26,597|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:56:26,600|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 17:56:26,602|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 17:56:26,801|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:56:26,819|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:56:26,859|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:56:26,874|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:56:26,881|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 17:56:26,886|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:56:26,887|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:26,898|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:26,915|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 17:56:26,930|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:56:26,937|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 17:56:26,952|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:56:26,953|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:26,956|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:26,968|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 17:56:26,971|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:56:26,973|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:26,976|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:26,987|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 17:56:26,992|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:56:26,993|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:26,998|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:27,011|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 17:56:27,066|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:56:27,067|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:27,107|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:27,140|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 17:56:27,173|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 17:56:27,193|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:56:27,218|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 17:56:27,249|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 17:56:27,269|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:56:27,271|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:27,287|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 17:56:27,305|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 17:56:27,315|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:56:27,316|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:56:27,326|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 17:56:27,336|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 17:56:45,407|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:56:49,728|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:56:49,734|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:56:49,740|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:56:49,746|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:56:49,753|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:57:57,396|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 17:57:57,409|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 17:57:57,419|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:57:57,421|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:57:57,423|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 17:57:57,435|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 17:57:57,461|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:57:57,463|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 17:57:57,466|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:57:57,471|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 17:57:57,473|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:57:57,475|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:57:57,478|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:57:57,493|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 17:57:57,498|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 17:57:57,499|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 17:58:00,324|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 17:58:00,327|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 17:58:00,356|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:58:00,359|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:00,368|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:00,384|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 17:58:00,403|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 17:58:00,728|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 17:58:00,761|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 17:58:00,769|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 17:58:00,796|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:58:00,799|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:00,803|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 17:58:00,804|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 17:58:00,809|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:00,828|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 17:58:00,829|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 17:58:01,099|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:58:01,120|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:58:01,167|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 17:58:01,182|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 17:58:01,185|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 17:58:01,188|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 17:58:01,525|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 17:58:01,542|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:58:01,588|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 17:58:01,603|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 17:58:01,613|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 17:58:01,617|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 17:58:01,618|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:01,630|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:01,653|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 17:58:01,672|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:58:01,681|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 17:58:01,697|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:58:01,699|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:01,702|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:01,719|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 17:58:01,723|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:58:01,724|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:01,726|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:01,740|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 17:58:01,745|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:58:01,747|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:01,753|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:01,768|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 17:58:01,843|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:58:01,845|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:01,879|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:01,921|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 17:58:01,960|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 17:58:01,989|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 17:58:02,015|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 17:58:02,059|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 17:58:02,089|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 17:58:02,090|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:02,101|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 17:58:02,119|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 17:58:02,132|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 17:58:02,134|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 17:58:02,143|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 17:58:02,156|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 17:58:27,823|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:58:32,378|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:58:32,384|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:58:32,389|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:58:32,395|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 17:58:32,400|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:02:14,888|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:14,901|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 18:02:14,909|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:02:14,911|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:14,915|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:14,930|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 18:02:14,932|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:02:14,935|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 18:02:14,957|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:02:14,962|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 18:02:14,966|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:02:14,968|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:14,971|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:14,987|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 18:02:14,994|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 18:02:14,995|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 18:02:17,196|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 18:02:17,197|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 18:02:17,222|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:02:17,224|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:17,233|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:17,247|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 18:02:17,257|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 18:02:17,550|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 18:02:17,577|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 18:02:17,586|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 18:02:17,610|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:02:17,611|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:17,614|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 18:02:17,616|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 18:02:17,619|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:17,637|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 18:02:17,639|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 18:02:17,852|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:02:17,866|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:02:17,903|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:02:17,922|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:02:17,925|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 18:02:17,926|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 18:02:18,194|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:02:18,212|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:02:18,251|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:02:18,266|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:02:18,274|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 18:02:18,279|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:02:18,280|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:18,293|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:18,315|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 18:02:18,332|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:02:18,340|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 18:02:18,359|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:02:18,360|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:18,364|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:18,379|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 18:02:18,382|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:02:18,383|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:18,386|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:18,400|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 18:02:18,405|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:02:18,406|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:18,411|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:18,424|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 18:02:18,475|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:02:18,476|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:18,511|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:18,542|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 18:02:18,572|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 18:02:18,592|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:02:18,619|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 18:02:18,654|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 18:02:18,676|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:02:18,678|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:18,695|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 18:02:18,713|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 18:02:18,724|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:02:18,725|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:02:18,733|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 18:02:18,743|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 18:02:40,608|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:02:45,093|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:02:45,101|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:02:45,107|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:02:45,113|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:02:45,119|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:05:34,354|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:34,368|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 18:05:34,377|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:05:34,379|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:34,383|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:34,395|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 18:05:34,416|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:05:34,420|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 18:05:34,423|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:05:34,426|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 18:05:34,429|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:05:34,430|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:34,435|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:34,451|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 18:05:34,456|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 18:05:34,457|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 18:05:36,831|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 18:05:36,833|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 18:05:36,871|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:05:36,873|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:36,889|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:36,926|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 18:05:36,937|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 18:05:37,214|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 18:05:37,243|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 18:05:37,253|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 18:05:37,271|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:05:37,273|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:37,276|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 18:05:37,277|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 18:05:37,281|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:37,297|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 18:05:37,299|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 18:05:37,667|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:05:37,693|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:05:37,773|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:05:37,799|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:05:37,803|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 18:05:37,808|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 18:05:38,182|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:05:38,208|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:05:38,281|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:05:38,304|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:05:38,314|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 18:05:38,321|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:05:38,323|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:38,340|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:38,368|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 18:05:38,394|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:05:38,405|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 18:05:38,430|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:05:38,432|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:38,435|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:38,453|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 18:05:38,457|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:05:38,459|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:38,461|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:38,482|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 18:05:38,488|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:05:38,489|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:38,496|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:38,520|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 18:05:38,619|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:05:38,621|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:38,675|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:38,731|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 18:05:38,782|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 18:05:38,812|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:05:38,849|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 18:05:38,911|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 18:05:38,942|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:05:38,944|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:38,968|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 18:05:38,992|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 18:05:39,005|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:05:39,007|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:05:39,019|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 18:05:39,032|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 18:06:00,986|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:06:08,476|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:06:08,483|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:06:08,490|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:06:08,498|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:06:08,506|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:11:29,524|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:29,537|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 18:11:29,543|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:11:29,544|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:29,547|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:29,558|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 18:11:29,577|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:11:29,580|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 18:11:29,583|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:11:29,585|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 18:11:29,588|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:11:29,589|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:29,593|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:29,603|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 18:11:29,608|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 18:11:29,610|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 18:11:31,777|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 18:11:31,779|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 18:11:31,811|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:11:31,813|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:31,824|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:31,839|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 18:11:31,849|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 18:11:32,113|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 18:11:32,142|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 18:11:32,151|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 18:11:32,168|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:11:32,169|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:32,172|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 18:11:32,174|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 18:11:32,177|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:32,192|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 18:11:32,192|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 18:11:32,458|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:11:32,470|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:11:32,507|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:11:32,519|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:11:32,522|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 18:11:32,523|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 18:11:32,698|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:11:32,723|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:11:32,757|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:11:32,771|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:11:32,777|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 18:11:32,781|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:11:32,782|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:32,793|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:32,808|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 18:11:32,821|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:11:32,828|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 18:11:32,841|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:11:32,842|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:32,845|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:32,856|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 18:11:32,859|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:11:32,860|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:32,862|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:32,873|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 18:11:32,877|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:11:32,879|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:32,883|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:32,895|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 18:11:32,945|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:11:32,946|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:32,980|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:33,012|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 18:11:33,045|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 18:11:33,064|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:11:33,085|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 18:11:33,114|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 18:11:33,133|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:11:33,134|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:33,142|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 18:11:33,156|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 18:11:33,165|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:11:33,166|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:11:33,170|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 18:11:33,176|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 18:11:51,579|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:11:55,882|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:11:55,887|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:11:55,892|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:11:55,898|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:11:55,904|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 18:14:54,659|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:54,672|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 18:14:54,681|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:14:54,683|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:54,686|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:54,708|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 18:14:54,734|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:14:54,737|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 18:14:54,739|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:14:54,742|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 18:14:54,745|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:14:54,748|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:54,752|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:54,767|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 18:14:54,774|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 18:14:54,775|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 18:14:57,213|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 18:14:57,214|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 18:14:57,244|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:14:57,245|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:57,257|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:57,273|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 18:14:57,283|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 18:14:57,577|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 18:14:57,606|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 18:14:57,616|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 18:14:57,637|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:14:57,639|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:57,644|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 18:14:57,646|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 18:14:57,649|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:57,663|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 18:14:57,665|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 18:14:57,969|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:14:57,983|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:14:58,025|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-02-29 18:14:58,043|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 18:14:58,047|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 18:14:58,049|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 18:14:58,250|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-02-29 18:14:58,264|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:14:58,307|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-02-29 18:14:58,323|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 18:14:58,332|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-02-29 18:14:58,338|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 18:14:58,340|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:58,357|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:58,377|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-02-29 18:14:58,397|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:14:58,407|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-02-29 18:14:58,424|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:14:58,426|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:58,429|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:58,447|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-02-29 18:14:58,451|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:14:58,453|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:58,457|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:58,476|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-02-29 18:14:58,480|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:14:58,482|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:58,488|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:58,504|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-02-29 18:14:58,570|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:14:58,572|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:58,601|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:58,635|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-02-29 18:14:58,675|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-02-29 18:14:58,699|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-02-29 18:14:58,729|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-02-29 18:14:58,765|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-02-29 18:14:58,790|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-02-29 18:14:58,792|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:58,800|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-02-29 18:14:58,816|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-02-29 18:14:58,827|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 18:14:58,828|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 18:14:58,840|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-02-29 18:14:58,849|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-02-29 18:15:20,099|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-02-29 19:26:00,681|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:00,760|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 19:26:00,784|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 19:26:00,787|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:00,800|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:00,846|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 19:26:00,906|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 19:26:00,912|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 19:26:00,919|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 19:26:00,947|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 19:26:00,952|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 19:26:00,955|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:00,964|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:01,008|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 19:26:01,021|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 19:26:01,023|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 19:26:03,567|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 19:26:03,580|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 19:26:03,654|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 19:26:03,656|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:03,678|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:03,710|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 19:26:03,746|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 19:26:04,152|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 19:26:04,211|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 19:26:04,230|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 19:26:04,298|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 19:26:04,301|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:04,311|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-02-29 19:26:04,314|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-02-29 19:26:04,321|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:04,364|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-02-29 19:26:04,367|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-02-29 19:26:04,416|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-02-29 19:26:04,589|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-02-29 19:26:04,593|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-02-29 19:26:05,133|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:05,157|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-02-29 19:26:05,171|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 19:26:05,174|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:05,180|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:05,213|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-02-29 19:26:05,260|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-02-29 19:26:05,265|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-02-29 19:26:05,270|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-02-29 19:26:05,276|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-02-29 19:26:05,281|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-02-29 19:26:05,283|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:05,291|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:05,327|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-02-29 19:26:05,338|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-02-29 19:26:05,341|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-02-29 19:26:07,380|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-02-29 19:26:07,382|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-02-29 19:26:07,468|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 19:26:07,471|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:07,487|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:07,513|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-02-29 19:26:07,544|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-02-29 19:26:07,896|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-02-29 19:26:07,929|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-02-29 19:26:07,941|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-02-29 19:26:07,966|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-02-29 19:26:07,968|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-02-29 19:26:07,972|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-02-29 19:26:07,974|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-02-29 19:26:07,980|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-02-29 19:26:07,999|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-02-29 19:26:08,001|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-02-29 19:26:08,028|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-02-29 19:26:08,091|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-02-29 19:26:08,094|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-02 17:51:30,658|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-02 17:51:30,696|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-02 17:51:30,711|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-02 17:51:30,713|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-02 17:51:30,720|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-02 17:51:30,746|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-02 17:51:30,752|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-02 17:51:30,757|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-02 17:51:30,795|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-02 17:51:30,800|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-02 17:51:30,804|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-02 17:51:30,807|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-02 17:51:30,817|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-02 17:51:30,842|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-02 17:51:30,850|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-02 17:51:30,859|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-02 17:51:32,715|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-02 17:51:32,716|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-02 17:51:32,784|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-02 17:51:32,786|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-02 17:51:32,800|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-02 17:51:32,826|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-02 17:51:32,854|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-02 17:51:33,212|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-02 17:51:33,256|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-02 17:51:33,272|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-02 17:51:33,320|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-02 17:51:33,323|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-02 17:51:33,327|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-02 17:51:33,329|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-02 17:51:33,335|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-02 17:51:33,361|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-02 17:51:33,364|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-02 17:51:33,401|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-02 17:51:33,519|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-02 17:51:33,523|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-03 11:25:41,861|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-03 11:25:41,898|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-03 11:25:41,911|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:25:41,913|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:25:41,918|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-03 11:25:41,948|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-03 11:25:41,952|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-03 11:25:41,957|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-03 11:25:42,002|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-03 11:25:42,013|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-03 11:25:42,017|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-03 11:25:42,020|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:25:42,029|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-03 11:25:42,066|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-03 11:25:42,077|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-03 11:25:42,079|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-03 11:25:44,338|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-03 11:25:44,340|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-03 11:25:44,440|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:25:44,443|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:25:44,450|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-03 11:25:44,498|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-03 11:25:44,540|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-03 11:25:44,992|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-03 11:25:45,093|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-03 11:25:45,116|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-03 11:25:45,156|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:25:45,159|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:25:45,165|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-03 11:25:45,168|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-03 11:25:45,175|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-03 11:25:45,204|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-03 11:25:45,206|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-03 11:25:45,247|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-03 11:25:45,355|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-03 11:25:45,359|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-03 11:32:50,240|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-03 11:32:50,285|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-03 11:32:50,306|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:32:50,309|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:32:50,316|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-03 11:32:50,358|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-03 11:32:50,402|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-03 11:32:50,407|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-03 11:32:50,412|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-03 11:32:50,416|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-03 11:32:50,421|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-03 11:32:50,425|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:32:50,433|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-03 11:32:50,455|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-03 11:32:50,464|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-03 11:32:50,466|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-03 11:32:52,966|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-03 11:32:52,968|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-03 11:32:53,058|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:32:53,061|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:32:53,067|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-03 11:32:53,106|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-03 11:32:53,147|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-03 11:32:53,566|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-03 11:32:53,624|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-03 11:32:53,642|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-03 11:32:53,686|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:32:53,689|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:32:53,696|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-03 11:32:53,700|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-03 11:32:53,707|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-03 11:32:53,749|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-03 11:32:53,751|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-03 11:32:53,798|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-03 11:32:53,899|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-03 11:32:53,903|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-03 11:59:03,237|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-03 11:59:03,270|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-03 11:59:03,284|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:59:03,287|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:59:03,297|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-03 11:59:03,327|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-03 11:59:03,337|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-03 11:59:03,344|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-03 11:59:03,398|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-03 11:59:03,404|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-03 11:59:03,410|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-03 11:59:03,414|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:59:03,433|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-03 11:59:03,470|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-03 11:59:03,483|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-03 11:59:03,486|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-03 11:59:05,956|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-03 11:59:05,958|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-03 11:59:06,044|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:59:06,045|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:59:06,050|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-03 11:59:06,084|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-03 11:59:06,140|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-03 11:59:06,573|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-03 11:59:06,626|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-03 11:59:06,645|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-03 11:59:06,688|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-03 11:59:06,691|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-03 11:59:06,698|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-03 11:59:06,701|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-03 11:59:06,709|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-03 11:59:06,762|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-03 11:59:06,765|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-03 11:59:06,821|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-03 11:59:06,918|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-03 11:59:06,922|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-06 23:26:34,535|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-06 23:26:34,557|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-06 23:26:34,566|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-06 23:26:34,567|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:26:34,571|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-06 23:26:34,587|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-06 23:26:34,588|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-06 23:26:34,591|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-06 23:26:34,612|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-06 23:26:34,615|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-06 23:26:34,617|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-06 23:26:34,619|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:26:34,624|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-06 23:26:34,636|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-06 23:26:34,642|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-06 23:26:34,646|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-06 23:26:36,065|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-06 23:26:36,066|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-06 23:26:36,112|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-06 23:26:36,113|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:26:36,124|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-06 23:26:36,146|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-06 23:26:36,161|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-06 23:26:36,387|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-06 23:26:36,418|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-06 23:26:36,430|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-06 23:26:36,463|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-06 23:26:36,464|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:26:36,468|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-06 23:26:36,469|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-06 23:26:36,473|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-06 23:26:36,493|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-06 23:26:36,495|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-06 23:26:36,593|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-06 23:26:36,671|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-06 23:26:36,675|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-06 23:50:54,047|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-06 23:50:54,059|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-06 23:50:54,068|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-06 23:50:54,070|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:50:54,074|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-06 23:50:54,087|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-06 23:50:54,090|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-06 23:50:54,093|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-06 23:50:54,113|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-06 23:50:54,116|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-06 23:50:54,120|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-06 23:50:54,121|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:50:54,125|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-06 23:50:54,137|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-06 23:50:54,144|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-06 23:50:54,146|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-06 23:50:55,524|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-06 23:50:55,525|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-06 23:50:55,566|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-06 23:50:55,567|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:50:55,575|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-06 23:50:55,588|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-06 23:50:55,603|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-06 23:50:55,815|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-06 23:50:55,843|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-06 23:50:55,852|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-06 23:50:55,873|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-06 23:50:55,874|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-06 23:50:55,877|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-06 23:50:55,879|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-06 23:50:55,883|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-06 23:50:55,899|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-06 23:50:55,901|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-06 23:50:55,989|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-06 23:50:56,023|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-06 23:50:56,024|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 01:02:04,369|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 01:02:04,383|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 01:02:04,393|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:02:04,394|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:02:04,397|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 01:02:04,415|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 01:02:04,417|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 01:02:04,420|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 01:02:04,441|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 01:02:04,444|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 01:02:04,446|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 01:02:04,448|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:02:04,454|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:02:04,467|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 01:02:04,476|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 01:02:04,477|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 01:02:05,890|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 01:02:05,891|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 01:02:05,934|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:02:05,935|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:02:05,947|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:02:05,961|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 01:02:05,975|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 01:02:06,261|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 01:02:06,296|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 01:02:06,308|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 01:02:06,332|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:02:06,333|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:02:06,337|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 01:02:06,339|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 01:02:06,343|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 01:02:06,363|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 01:02:06,365|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 01:02:06,390|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 01:02:06,442|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 01:02:06,445|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 01:14:29,812|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 01:14:29,831|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 01:14:29,841|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:14:29,842|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:14:29,845|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 01:14:29,858|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 01:14:29,861|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 01:14:29,865|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 01:14:29,891|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 01:14:29,894|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 01:14:29,899|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 01:14:29,901|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:14:29,908|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:14:29,923|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 01:14:29,928|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 01:14:29,930|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 01:14:31,465|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 01:14:31,467|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 01:14:31,515|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:14:31,516|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:14:31,524|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:14:31,544|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 01:14:31,561|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 01:14:31,879|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 01:14:31,919|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 01:14:31,931|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 01:14:31,956|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:14:31,958|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:14:31,963|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 01:14:31,964|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 01:14:31,969|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 01:14:31,986|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 01:14:31,988|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 01:14:32,084|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-07 01:14:32,127|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 01:14:32,130|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 01:36:08,032|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 01:36:08,047|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 01:36:08,057|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:36:08,058|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:36:08,062|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 01:36:08,079|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 01:36:08,082|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 01:36:08,085|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 01:36:08,108|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 01:36:08,111|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 01:36:08,113|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 01:36:08,114|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:36:08,118|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:36:08,139|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 01:36:08,144|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 01:36:08,145|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 01:36:09,585|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 01:36:09,586|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 01:36:09,632|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:36:09,633|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:36:09,645|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:36:09,660|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 01:36:09,674|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 01:36:09,903|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 01:36:09,939|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 01:36:09,948|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 01:36:09,973|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:36:09,975|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:36:09,978|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 01:36:09,980|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 01:36:09,984|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 01:36:10,003|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 01:36:10,005|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 01:36:10,110|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-07 01:36:10,158|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 01:36:10,160|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 01:39:15,982|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 01:39:15,998|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 01:39:16,007|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:39:16,008|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:39:16,013|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 01:39:16,030|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 01:39:16,055|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 01:39:16,060|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 01:39:16,064|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 01:39:16,068|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 01:39:16,071|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 01:39:16,073|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:39:16,079|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:39:16,099|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 01:39:16,106|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 01:39:16,107|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 01:39:18,043|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 01:39:18,044|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 01:39:18,093|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:39:18,095|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:39:18,105|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:39:18,121|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 01:39:18,137|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 01:39:18,407|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 01:39:18,451|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 01:39:18,466|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 01:39:18,495|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:39:18,496|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:39:18,500|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 01:39:18,503|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 01:39:18,507|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 01:39:18,532|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 01:39:18,535|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 01:39:18,641|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 01:39:18,686|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 01:39:18,688|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 01:40:49,668|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 01:40:49,688|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 01:40:49,697|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:40:49,699|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:40:49,703|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 01:40:49,725|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 01:40:49,728|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 01:40:49,731|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 01:40:49,762|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 01:40:49,767|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 01:40:49,772|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 01:40:49,774|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:40:49,779|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:40:49,798|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 01:40:49,805|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 01:40:49,807|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 01:40:51,476|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 01:40:51,477|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 01:40:51,532|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:40:51,534|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:40:51,544|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 01:40:51,559|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 01:40:51,576|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 01:40:51,853|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 01:40:51,887|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 01:40:51,898|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 01:40:51,923|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 01:40:51,925|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 01:40:51,928|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 01:40:51,930|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 01:40:51,935|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 01:40:51,958|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 01:40:51,960|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 01:40:52,065|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 01:40:52,112|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 01:40:52,114|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 02:54:17,776|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 02:54:17,793|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 02:54:17,802|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 02:54:17,803|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 02:54:17,806|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 02:54:17,822|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 02:54:17,825|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 02:54:17,827|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 02:54:17,850|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 02:54:17,854|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 02:54:17,857|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 02:54:17,859|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 02:54:17,864|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 02:54:17,877|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 02:54:17,884|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 02:54:17,885|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 02:54:19,243|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 02:54:19,243|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 02:54:19,286|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 02:54:19,288|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 02:54:19,297|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 02:54:19,309|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 02:54:19,328|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 02:54:19,595|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 02:54:19,630|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 02:54:19,640|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 02:54:19,660|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 02:54:19,661|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 02:54:19,664|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 02:54:19,666|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 02:54:19,670|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 02:54:19,685|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 02:54:19,687|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 02:54:19,708|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 02:54:19,761|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 02:54:19,763|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 03:32:58,735|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 03:32:58,753|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 03:32:58,762|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:32:58,764|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:32:58,767|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 03:32:58,782|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 03:32:58,805|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 03:32:58,809|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 03:32:58,811|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 03:32:58,814|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 03:32:58,816|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 03:32:58,817|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:32:58,822|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 03:32:58,838|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 03:32:58,843|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 03:32:58,844|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 03:33:00,402|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 03:33:00,403|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 03:33:00,454|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:33:00,456|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:33:00,467|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 03:33:00,482|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 03:33:00,499|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 03:33:00,857|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 03:33:00,887|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 03:33:00,897|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 03:33:00,919|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:33:00,921|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:33:00,924|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 03:33:00,926|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 03:33:00,929|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 03:33:00,946|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 03:33:00,948|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 03:33:00,972|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-07 03:33:01,030|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 03:33:01,033|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 03:34:26,347|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 03:34:26,370|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 03:34:26,383|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:34:26,385|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:34:26,389|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 03:34:26,412|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 03:34:26,416|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 03:34:26,420|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 03:34:26,452|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 03:34:26,457|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 03:34:26,463|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 03:34:26,465|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:34:26,472|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 03:34:26,493|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 03:34:26,500|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 03:34:26,502|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 03:34:28,182|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 03:34:28,183|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 03:34:28,228|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:34:28,230|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:34:28,243|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 03:34:28,268|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 03:34:28,288|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 03:34:28,709|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 03:34:28,742|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 03:34:28,756|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 03:34:28,784|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:34:28,786|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:34:28,792|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 03:34:28,794|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 03:34:28,800|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 03:34:28,830|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 03:34:28,832|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 03:34:28,868|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 03:34:28,933|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 03:34:28,935|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 03:38:58,852|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 03:38:58,868|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 03:38:58,879|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:38:58,881|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:38:58,884|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 03:38:58,903|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 03:38:58,905|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 03:38:58,909|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 03:38:58,936|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 03:38:58,940|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 03:38:58,943|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 03:38:58,945|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:38:58,951|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 03:38:58,970|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 03:38:58,978|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 03:38:58,981|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 03:39:00,566|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 03:39:00,568|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 03:39:00,635|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:39:00,637|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:39:00,648|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 03:39:00,676|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 03:39:00,691|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 03:39:01,091|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 03:39:01,122|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 03:39:01,134|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 03:39:01,155|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 03:39:01,157|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 03:39:01,161|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 03:39:01,163|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 03:39:01,167|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 03:39:01,185|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 03:39:01,187|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 03:39:01,207|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 03:39:01,267|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 03:39:01,269|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 04:00:34,266|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 04:00:34,280|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 04:00:34,291|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:00:34,293|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:00:34,296|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 04:00:34,310|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 04:00:34,313|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 04:00:34,317|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 04:00:34,346|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 04:00:34,350|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 04:00:34,352|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 04:00:34,354|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:00:34,358|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:00:34,374|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 04:00:34,379|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 04:00:34,381|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 04:00:35,876|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 04:00:35,877|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 04:00:35,920|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:00:35,921|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:00:35,931|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:00:35,947|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 04:00:35,962|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 04:00:36,327|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 04:00:36,360|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 04:00:36,372|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 04:00:36,396|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:00:36,398|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:00:36,401|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 04:00:36,403|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 04:00:36,407|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 04:00:36,426|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 04:00:36,428|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 04:00:36,451|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 04:00:36,509|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 04:00:36,511|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 04:03:36,733|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 04:03:36,750|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 04:03:36,761|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:03:36,763|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:03:36,766|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 04:03:36,781|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 04:03:36,807|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 04:03:36,810|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 04:03:36,814|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 04:03:36,817|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 04:03:36,819|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 04:03:36,820|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:03:36,826|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:03:36,843|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 04:03:36,850|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 04:03:36,852|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 04:03:38,358|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 04:03:38,360|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 04:03:38,406|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:03:38,408|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:03:38,420|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:03:38,438|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 04:03:38,455|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 04:03:38,809|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 04:03:38,844|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 04:03:38,855|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 04:03:38,881|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:03:38,883|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:03:38,887|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 04:03:38,889|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 04:03:38,893|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 04:03:38,912|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 04:03:38,914|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 04:03:38,937|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 04:03:39,000|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 04:03:39,003|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 04:05:07,652|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 04:05:07,668|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 04:05:07,678|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:05:07,679|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:05:07,684|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 04:05:07,703|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 04:05:07,737|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 04:05:07,742|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 04:05:07,746|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 04:05:07,752|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 04:05:07,756|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 04:05:07,759|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:05:07,765|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:05:07,789|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 04:05:07,795|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 04:05:07,797|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 04:05:09,505|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 04:05:09,506|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 04:05:09,554|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:05:09,556|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:05:09,568|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:05:09,586|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 04:05:09,602|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 04:05:10,024|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 04:05:10,059|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 04:05:10,071|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 04:05:10,097|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:05:10,099|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:05:10,103|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 04:05:10,105|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 04:05:10,110|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 04:05:10,130|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 04:05:10,132|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 04:05:10,164|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-07 04:05:10,233|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 04:05:10,235|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 04:08:05,656|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 04:08:05,677|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 04:08:05,685|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:08:05,687|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:08:05,691|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 04:08:05,714|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 04:08:05,748|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 04:08:05,753|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 04:08:05,756|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 04:08:05,760|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 04:08:05,766|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 04:08:05,769|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:08:05,777|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:08:05,796|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 04:08:05,805|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 04:08:05,807|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 04:08:07,554|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 04:08:07,555|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 04:08:07,607|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:08:07,608|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:08:07,619|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:08:07,637|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 04:08:07,655|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 04:08:08,140|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 04:08:08,175|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 04:08:08,188|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 04:08:08,217|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:08:08,219|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:08:08,223|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 04:08:08,226|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 04:08:08,230|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 04:08:08,257|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 04:08:08,259|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 04:08:08,293|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-07 04:08:08,360|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 04:08:08,363|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 04:09:11,410|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 04:09:11,430|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 04:09:11,442|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:09:11,444|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:09:11,451|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 04:09:11,474|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 04:09:11,511|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 04:09:11,516|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 04:09:11,519|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 04:09:11,524|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 04:09:11,530|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 04:09:11,534|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:09:11,544|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:09:11,563|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 04:09:11,574|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 04:09:11,576|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 04:09:13,428|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 04:09:13,429|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 04:09:13,478|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:09:13,480|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:09:13,542|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 04:09:13,565|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 04:09:13,601|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 04:09:14,270|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 04:09:14,317|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 04:09:14,331|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 04:09:14,364|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 04:09:14,366|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 04:09:14,371|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 04:09:14,373|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 04:09:14,380|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 04:09:14,409|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 04:09:14,411|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 04:09:14,445|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-07 04:09:14,536|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 04:09:14,540|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 05:45:36,191|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 05:45:36,206|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 05:45:36,216|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 05:45:36,218|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 05:45:36,221|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 05:45:36,236|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 05:45:36,262|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 05:45:36,265|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 05:45:36,268|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 05:45:36,273|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 05:45:36,275|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 05:45:36,277|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 05:45:36,280|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 05:45:36,299|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 05:45:36,304|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 05:45:36,305|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 05:45:37,799|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 05:45:37,800|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 05:45:37,842|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 05:45:37,844|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 05:45:37,854|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 05:45:37,869|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 05:45:37,883|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 05:45:38,213|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 05:45:38,246|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 05:45:38,258|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 05:45:38,280|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 05:45:38,281|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 05:45:38,285|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 05:45:38,286|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 05:45:38,290|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 05:45:38,307|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 05:45:38,309|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 05:45:38,328|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-07 05:45:38,383|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-07 05:45:38,385|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-07 06:00:37,172|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:37,185|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 06:00:37,192|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:00:37,193|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:37,195|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:37,208|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 06:00:37,228|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:00:37,231|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 06:00:37,233|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:00:37,236|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 06:00:37,238|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:00:37,240|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:37,243|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:37,262|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 06:00:37,269|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 06:00:37,271|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 06:00:39,705|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 06:00:39,706|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 06:00:39,758|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:00:39,760|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:39,770|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:39,784|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 06:00:39,794|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 06:00:40,116|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 06:00:40,148|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 06:00:40,157|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 06:00:40,178|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:00:40,179|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:40,182|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 06:00:40,183|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 06:00:40,187|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:40,202|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 06:00:40,204|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 06:00:40,679|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:00:40,705|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:00:40,765|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:00:40,783|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:00:40,785|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 06:00:40,787|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 06:00:41,176|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:00:41,197|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:00:41,268|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:00:41,283|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:00:41,292|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 06:00:41,297|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:00:41,298|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:41,310|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:41,331|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 06:00:41,346|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:00:41,356|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 06:00:41,376|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:00:41,377|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:41,380|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:41,390|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 06:00:41,393|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:00:41,395|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:41,396|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:41,409|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 06:00:41,415|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:00:41,416|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:41,421|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:41,437|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 06:00:41,484|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:00:41,485|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:41,511|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:41,545|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 06:00:41,576|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 06:00:41,599|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:00:41,632|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 06:00:41,671|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 06:00:41,696|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:00:41,697|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:41,718|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 06:00:41,740|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 06:00:41,760|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:00:41,761|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:00:41,772|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 06:00:41,785|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 06:34:32,542|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:32,570|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 06:34:32,579|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:34:32,581|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:32,584|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:32,598|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 06:34:32,622|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:34:32,625|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 06:34:32,628|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:34:32,631|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 06:34:32,634|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:34:32,636|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:32,642|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:32,655|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 06:34:32,661|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 06:34:32,662|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 06:34:34,060|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 06:34:34,061|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 06:34:34,115|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:34:34,116|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:34,128|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:34,142|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 06:34:34,153|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 06:34:34,569|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 06:34:34,617|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 06:34:34,630|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 06:34:34,662|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:34:34,663|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:34,667|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 06:34:34,668|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 06:34:34,672|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:34,691|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 06:34:34,692|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 06:34:35,088|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:34:35,115|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:34:35,182|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:34:35,196|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:34:35,199|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 06:34:35,200|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 06:34:35,663|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:34:35,678|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:34:35,744|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:34:35,760|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:34:35,766|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 06:34:35,772|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:34:35,773|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:35,787|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:35,809|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 06:34:35,826|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:34:35,836|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 06:34:35,850|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:34:35,851|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:35,854|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:35,866|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 06:34:35,870|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:34:35,871|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:35,873|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:35,887|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 06:34:35,893|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:34:35,894|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:35,901|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:35,919|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 06:34:35,977|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:34:35,979|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:36,011|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:36,054|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 06:34:36,100|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 06:34:36,129|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:34:36,163|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 06:34:36,200|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 06:34:36,229|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:34:36,231|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:36,255|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 06:34:36,275|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 06:34:36,285|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:34:36,286|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:34:36,296|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 06:34:36,305|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 06:52:58,388|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 06:52:58,407|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 06:52:58,414|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:52:58,415|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:52:58,419|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 06:52:58,436|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 06:52:58,438|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:52:58,443|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 06:52:58,467|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:52:58,473|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 06:52:58,477|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:52:58,479|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:52:58,483|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:52:58,501|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 06:52:58,507|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 06:52:58,510|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 06:53:00,035|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 06:53:00,037|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 06:53:00,094|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:53:00,097|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:00,107|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:00,125|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 06:53:00,135|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 06:53:00,588|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 06:53:00,631|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 06:53:00,643|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 06:53:00,667|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:53:00,669|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:00,672|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 06:53:00,674|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 06:53:00,678|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:00,691|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 06:53:00,693|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 06:53:01,168|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:53:01,191|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:53:01,269|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:53:01,286|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:53:01,289|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 06:53:01,290|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 06:53:01,681|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:53:01,706|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:53:01,776|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:53:01,792|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:53:01,799|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 06:53:01,805|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:53:01,806|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:01,820|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:01,844|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 06:53:01,865|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:53:01,872|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 06:53:01,886|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:53:01,887|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:01,890|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:01,903|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 06:53:01,906|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:53:01,908|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:01,911|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:01,928|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 06:53:01,933|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:53:01,935|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:01,942|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:01,956|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 06:53:02,019|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:53:02,022|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:02,060|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:02,107|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 06:53:02,145|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 06:53:02,171|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:53:02,201|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 06:53:02,242|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 06:53:02,274|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:53:02,276|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:02,289|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 06:53:02,312|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 06:53:02,325|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:53:02,326|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:53:02,331|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 06:53:02,342|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 06:54:13,679|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:13,694|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 06:54:13,701|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:54:13,702|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:13,706|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:13,726|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 06:54:13,729|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:54:13,732|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 06:54:13,758|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:54:13,762|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 06:54:13,766|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:54:13,767|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:13,772|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:13,787|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 06:54:13,794|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 06:54:13,796|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 06:54:15,399|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 06:54:15,401|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 06:54:15,460|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:54:15,461|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:15,473|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:15,489|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 06:54:15,500|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 06:54:15,933|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 06:54:15,970|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 06:54:15,984|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 06:54:16,009|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:54:16,011|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:16,015|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 06:54:16,017|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 06:54:16,022|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:16,042|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 06:54:16,044|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 06:54:16,689|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:54:16,711|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:54:16,788|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 06:54:16,806|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 06:54:16,810|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 06:54:16,812|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 06:54:17,276|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 06:54:17,299|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:54:17,390|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 06:54:17,410|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 06:54:17,417|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 06:54:17,424|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 06:54:17,426|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:17,443|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:17,464|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 06:54:17,486|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:54:17,494|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 06:54:17,512|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:54:17,513|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:17,516|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:17,530|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 06:54:17,533|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:54:17,535|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:17,537|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:17,557|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 06:54:17,563|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:54:17,564|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:17,572|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:17,591|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 06:54:17,661|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:54:17,663|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:17,703|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:17,762|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 06:54:17,816|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 06:54:17,846|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 06:54:17,878|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 06:54:17,928|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 06:54:17,958|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 06:54:17,959|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:17,972|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 06:54:17,992|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 06:54:18,004|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 06:54:18,005|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 06:54:18,012|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 06:54:18,022|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 07:35:41,389|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:41,413|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 07:35:41,420|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:35:41,421|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:41,424|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:41,442|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 07:35:41,444|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 07:35:41,446|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 07:35:41,469|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 07:35:41,472|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 07:35:41,474|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 07:35:41,475|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:41,479|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:41,495|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 07:35:41,499|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 07:35:41,501|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 07:35:42,874|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 07:35:42,875|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 07:35:42,916|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:35:42,919|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:42,929|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:42,943|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 07:35:42,952|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 07:35:43,302|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 07:35:43,333|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 07:35:43,345|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 07:35:43,368|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:35:43,370|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:43,373|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 07:35:43,374|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 07:35:43,378|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:43,394|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 07:35:43,396|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 07:35:43,920|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 07:35:43,943|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 07:35:44,011|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 07:35:44,035|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 07:35:44,039|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 07:35:44,041|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 07:35:44,428|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 07:35:44,442|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 07:35:44,512|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 07:35:44,530|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 07:35:44,537|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 07:35:44,542|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 07:35:44,543|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:44,555|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:44,582|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 07:35:44,600|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 07:35:44,607|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 07:35:44,621|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 07:35:44,622|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:44,625|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:44,639|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 07:35:44,643|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:35:44,644|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:44,646|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:44,663|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 07:35:44,668|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:35:44,669|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:44,675|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:44,693|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 07:35:44,744|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:35:44,746|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:44,781|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:44,820|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 07:35:44,868|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 07:35:44,896|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 07:35:44,926|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 07:35:44,970|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 07:35:45,000|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 07:35:45,002|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:45,013|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 07:35:45,039|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 07:35:45,052|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:35:45,053|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:35:45,062|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 07:35:45,080|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 07:43:50,062|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:50,076|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 07:43:50,084|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:43:50,086|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:50,089|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:50,104|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 07:43:50,107|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 07:43:50,111|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 07:43:50,134|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 07:43:50,138|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 07:43:50,140|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 07:43:50,141|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:50,144|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:50,160|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 07:43:50,166|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 07:43:50,167|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 07:43:51,496|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 07:43:51,497|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 07:43:51,542|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:43:51,543|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:51,555|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:51,568|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 07:43:51,577|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 07:43:51,902|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 07:43:51,933|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 07:43:51,942|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 07:43:51,964|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:43:51,966|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:51,969|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 07:43:51,971|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 07:43:51,974|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:51,990|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 07:43:51,992|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 07:43:52,361|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 07:43:52,384|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 07:43:52,438|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 07:43:52,453|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 07:43:52,456|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 07:43:52,457|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 07:43:52,881|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 07:43:52,906|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 07:43:52,964|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 07:43:52,979|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 07:43:52,985|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 07:43:52,991|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 07:43:52,992|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:53,005|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:53,028|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 07:43:53,047|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 07:43:53,057|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 07:43:53,070|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 07:43:53,071|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:53,074|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:53,085|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 07:43:53,088|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:43:53,089|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:53,090|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:53,108|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 07:43:53,112|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:43:53,114|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:53,119|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:53,135|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 07:43:53,184|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:43:53,185|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:53,213|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:53,250|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 07:43:53,290|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 07:43:53,310|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 07:43:53,345|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 07:43:53,388|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 07:43:53,414|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 07:43:53,416|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:53,428|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 07:43:53,449|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 07:43:53,459|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 07:43:53,460|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 07:43:53,465|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 07:43:53,473|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:09:25,482|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:25,497|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:09:25,503|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:09:25,505|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:25,508|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:25,523|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:09:25,544|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:09:25,549|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:09:25,555|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:09:25,569|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:09:25,573|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:09:25,575|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:25,582|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:25,599|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:09:25,606|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:09:25,608|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:09:27,468|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:09:27,471|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:09:27,523|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:09:27,525|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:27,539|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:27,555|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:09:27,566|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:09:27,964|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:09:27,996|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:09:28,006|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:09:28,032|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:09:28,034|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:28,038|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 08:09:28,039|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 08:09:28,044|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:28,064|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:09:28,066|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:09:28,599|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:09:28,618|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:09:28,676|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:09:28,692|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:09:28,695|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:09:28,697|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:09:29,068|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:09:29,082|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:09:29,132|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:09:29,147|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:09:29,153|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:09:29,158|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:09:29,160|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:29,171|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:29,187|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:09:29,200|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:09:29,207|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:09:29,220|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:09:29,221|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:29,224|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:29,236|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:09:29,239|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:09:29,240|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:29,242|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:29,256|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:09:29,260|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:09:29,262|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:29,267|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:29,280|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:09:29,321|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:09:29,323|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:29,352|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:29,385|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:09:29,417|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:09:29,436|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:09:29,458|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:09:29,494|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:09:29,515|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:09:29,516|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:29,529|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:09:29,545|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:09:29,553|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:09:29,555|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:09:29,559|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:09:29,567|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:14:33,737|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:33,755|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:14:33,763|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:14:33,765|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:33,767|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:33,785|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:14:33,805|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:14:33,810|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:14:33,812|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:14:33,816|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:14:33,818|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:14:33,820|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:33,823|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:33,839|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:14:33,845|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:14:33,846|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:14:35,181|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:14:35,182|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:14:35,228|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:14:35,230|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:35,243|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:35,261|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:14:35,271|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:14:35,685|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:14:35,714|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:14:35,727|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:14:35,749|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:14:35,750|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:35,753|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 08:14:35,755|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 08:14:35,759|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:35,778|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:14:35,780|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:14:36,205|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:14:36,221|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:14:36,287|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:14:36,303|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:14:36,306|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:14:36,307|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:14:36,793|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:14:36,810|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:14:36,877|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:14:36,893|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:14:36,900|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:14:36,905|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:14:36,907|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:36,922|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:36,940|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:14:36,960|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:14:36,967|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:14:36,981|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:14:36,983|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:36,986|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:37,001|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:14:37,004|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:14:37,006|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:37,008|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:37,027|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:14:37,032|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:14:37,033|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:37,039|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:37,054|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:14:37,104|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:14:37,106|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:37,136|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:37,179|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:14:37,233|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:14:37,266|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:14:37,303|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:14:37,353|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:14:37,387|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:14:37,389|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:37,400|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:14:37,429|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:14:37,442|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:14:37,444|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:14:37,450|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:14:37,462|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:27:24,665|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:24,679|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:27:24,688|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:27:24,689|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:24,691|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:24,707|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:27:24,728|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:27:24,731|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:27:24,734|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:27:24,737|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:27:24,740|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:27:24,741|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:24,745|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:24,762|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:27:24,768|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:27:24,769|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:27:26,158|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:27:26,160|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:27:26,220|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:27:26,221|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:26,231|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:26,248|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:27:26,269|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:27:26,622|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:27:26,659|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:27:26,671|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:27:26,693|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:27:26,694|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:26,698|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 08:27:26,699|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 08:27:26,703|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:26,719|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:27:26,721|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:27:27,119|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:27:27,147|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:27:27,213|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:27:27,229|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:27:27,232|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:27:27,234|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:27:27,697|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:27:27,722|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:27:27,782|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:27:27,797|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:27:27,804|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:27:27,810|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:27:27,811|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:27,828|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:27,849|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:27:27,866|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:27:27,874|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:27:27,889|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:27:27,890|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:27,893|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:27,907|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:27:27,911|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:27:27,912|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:27,915|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:27,935|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:27:27,940|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:27:27,943|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:27,950|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:27,963|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:27:28,027|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:27:28,029|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:28,066|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:28,110|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:27:28,147|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:27:28,168|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:27:28,196|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:27:28,250|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:27:28,285|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:27:28,287|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:28,302|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:27:28,329|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:27:28,346|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:27:28,348|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:27:28,356|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:27:28,370|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:45:20,150|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:20,174|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:45:20,188|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:45:20,189|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:20,193|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:20,213|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:45:20,217|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:45:20,221|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:45:20,248|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:45:20,252|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:45:20,256|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:45:20,257|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:20,261|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:20,279|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:45:20,286|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:45:20,287|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:45:21,922|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:45:21,924|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:45:21,987|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:45:21,989|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:22,000|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:22,017|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:45:22,036|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:45:22,591|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:45:22,676|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:45:22,698|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:45:22,769|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:45:22,771|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:22,796|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.5724020442930153
[2020-03-07 08:45:22,799|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.5714285714285714
[2020-03-07 08:45:22,805|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:22,838|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:45:22,840|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:45:23,466|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:45:23,494|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:45:23,585|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:45:23,606|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:45:23,611|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:45:23,613|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:45:24,215|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:45:24,247|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:45:24,359|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:45:24,384|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:45:24,395|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:45:24,403|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:45:24,405|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:24,428|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:24,458|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:45:24,488|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:45:24,500|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:45:24,520|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:45:24,522|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:24,526|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:24,551|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:45:24,556|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:45:24,558|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:24,561|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:24,586|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:45:24,592|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:45:24,594|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:24,601|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:24,628|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:45:24,756|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:45:24,759|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:24,798|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:24,857|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:45:24,914|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:45:24,946|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:45:24,990|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:45:25,044|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:45:25,079|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:45:25,081|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:25,108|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:45:25,135|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:45:25,146|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:45:25,148|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:45:25,160|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:45:25,174|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:47:50,129|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:50,150|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:47:50,162|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:47:50,164|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:50,167|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:50,191|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:47:50,243|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:47:50,247|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:47:50,252|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:47:50,256|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:47:50,261|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:47:50,264|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:50,271|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:50,302|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:47:50,311|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:47:50,314|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:47:52,596|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:47:52,599|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:47:52,728|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:47:52,731|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:52,748|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:52,775|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:47:52,794|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:47:53,308|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:47:53,364|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:47:53,381|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:47:53,419|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:47:53,422|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:53,427|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 08:47:53,430|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 08:47:53,436|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:53,470|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:47:53,472|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:47:54,294|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:47:54,331|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:47:54,437|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:47:54,459|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:47:54,464|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:47:54,465|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:47:55,235|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:47:55,277|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:47:55,434|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:47:55,473|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:47:55,488|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:47:55,498|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:47:55,501|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:55,527|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:55,575|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:47:55,614|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:47:55,631|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:47:55,662|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:47:55,664|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:55,669|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:55,702|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:47:55,710|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:47:55,713|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:55,717|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:55,751|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:47:55,761|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:47:55,764|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:55,787|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:55,821|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:47:55,964|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:47:55,967|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:56,028|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:56,115|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:47:56,206|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:47:56,269|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:47:56,339|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:47:56,437|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:47:56,490|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:47:56,493|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:56,514|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:47:56,565|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:47:56,595|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:47:56,599|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:47:56,611|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:47:56,638|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:49:52,192|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:52,208|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:49:52,221|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:49:52,222|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:52,226|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:52,249|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:49:52,255|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:49:52,261|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:49:52,301|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:49:52,306|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:49:52,308|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:49:52,311|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:52,323|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:52,358|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:49:52,369|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:49:52,371|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:49:54,107|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:49:54,108|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:49:54,179|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:49:54,181|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:54,197|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:54,221|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:49:54,239|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:49:54,802|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:49:54,860|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:49:54,876|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:49:54,915|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:49:54,917|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:54,923|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.4629032258064516
[2020-03-07 08:49:54,925|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.4645161290322581
[2020-03-07 08:49:54,931|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:54,958|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:49:54,960|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:49:55,511|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:49:55,555|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:49:55,639|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:49:55,665|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:49:55,669|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:49:55,671|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:49:56,364|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:49:56,406|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:49:56,489|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:49:56,512|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:49:56,523|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:49:56,530|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:49:56,532|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:56,546|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:56,576|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:49:56,602|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:49:56,615|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:49:56,649|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:49:56,653|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:56,663|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:56,712|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:49:56,721|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:49:56,723|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:56,732|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:56,796|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:49:56,812|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:49:56,814|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:56,828|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:56,871|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:49:57,118|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:49:57,122|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:57,190|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:57,310|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:49:57,417|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:49:57,476|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:49:57,532|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:49:57,611|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:49:57,660|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:49:57,662|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:57,696|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:49:57,725|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:49:57,745|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:49:57,747|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:49:57,767|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:49:57,793|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:51:42,689|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:42,713|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:51:42,722|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:51:42,724|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:42,728|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:42,748|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:51:42,752|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:51:42,756|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:51:42,788|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:51:42,793|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:51:42,797|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:51:42,800|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:42,808|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:42,827|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:51:42,838|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:51:42,840|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:51:44,412|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:51:44,414|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:51:44,465|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:51:44,467|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:44,477|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:44,495|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:51:44,505|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:51:44,913|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:51:44,956|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:51:44,967|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:51:44,990|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:51:44,992|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:44,996|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.2735229759299781
[2020-03-07 08:51:44,997|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.26956521739130435
[2020-03-07 08:51:45,001|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:45,019|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:51:45,020|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:51:45,499|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:51:45,527|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:51:45,597|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:51:45,615|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:51:45,618|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:51:45,619|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:51:46,097|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:51:46,119|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:51:46,190|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:51:46,208|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:51:46,216|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:51:46,221|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:51:46,222|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:46,236|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:46,256|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:51:46,271|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:51:46,279|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:51:46,292|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:51:46,294|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:46,296|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:46,311|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:51:46,314|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:51:46,315|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:46,317|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:46,332|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:51:46,337|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:51:46,339|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:46,344|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:46,365|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:51:46,448|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:51:46,450|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:46,485|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:46,546|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:51:46,592|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:51:46,621|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:51:46,647|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:51:46,687|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:51:46,711|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:51:46,713|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:46,731|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:51:46,748|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:51:46,759|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:51:46,760|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:51:46,769|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:51:46,777|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-07 08:52:45,759|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:45,782|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-07 08:52:45,793|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:52:45,795|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:45,799|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:45,826|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-07 08:52:45,861|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:52:45,866|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-07 08:52:45,870|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:52:45,876|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-07 08:52:45,879|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:52:45,881|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:45,889|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:45,917|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-07 08:52:45,924|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-07 08:52:45,928|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-07 08:52:47,641|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-07 08:52:47,643|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-07 08:52:47,719|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:52:47,721|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:47,737|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:47,759|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-07 08:52:47,772|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-07 08:52:48,324|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-07 08:52:48,383|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-07 08:52:48,401|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-07 08:52:48,442|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:52:48,445|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:48,451|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-07 08:52:48,453|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-07 08:52:48,461|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:48,502|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-07 08:52:48,506|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-07 08:52:49,243|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:52:49,276|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:52:49,374|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-07 08:52:49,397|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-07 08:52:49,402|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-07 08:52:49,404|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-07 08:52:50,165|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-07 08:52:50,212|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:52:50,321|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-07 08:52:50,365|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-07 08:52:50,383|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-07 08:52:50,398|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-07 08:52:50,401|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:50,436|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:50,492|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-07 08:52:50,525|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:52:50,543|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-07 08:52:50,579|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:52:50,582|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:50,589|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:50,621|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-07 08:52:50,631|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:52:50,634|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:50,638|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:50,672|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-07 08:52:50,683|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:52:50,685|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:50,695|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:50,729|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-07 08:52:50,818|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:52:50,820|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:50,865|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:50,922|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-07 08:52:50,980|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-07 08:52:51,015|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-07 08:52:51,055|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-07 08:52:51,118|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-07 08:52:51,160|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-07 08:52:51,162|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:51,177|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-07 08:52:51,212|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-07 08:52:51,230|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-07 08:52:51,232|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-07 08:52:51,239|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-07 08:52:51,255|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-09 19:17:09,933|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:09,979|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-09 19:17:09,992|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-09 19:17:09,994|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:09,997|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:10,023|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-09 19:17:10,026|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-09 19:17:10,029|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-09 19:17:10,059|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-09 19:17:10,063|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-09 19:17:10,066|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-09 19:17:10,068|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:10,076|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:10,092|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-09 19:17:10,100|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-09 19:17:10,102|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-09 19:17:11,649|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-09 19:17:11,651|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-09 19:17:11,768|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-09 19:17:11,772|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:11,792|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:11,819|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-09 19:17:11,843|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-09 19:17:12,381|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-09 19:17:12,430|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-09 19:17:12,446|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-09 19:17:12,494|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-09 19:17:12,496|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:12,499|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-09 19:17:12,501|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-09 19:17:12,506|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:12,530|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-09 19:17:12,532|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-09 19:17:13,118|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-09 19:17:13,152|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-09 19:17:13,275|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-09 19:17:13,306|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-09 19:17:13,311|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-09 19:17:13,313|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-09 19:17:13,918|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-09 19:17:13,957|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-09 19:17:14,073|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-09 19:17:14,103|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-09 19:17:14,118|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-09 19:17:14,127|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-09 19:17:14,130|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:14,152|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:14,193|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-09 19:17:14,226|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-09 19:17:14,241|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-09 19:17:14,269|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-09 19:17:14,272|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:14,276|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:14,302|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-09 19:17:14,307|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-09 19:17:14,309|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:14,312|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:14,341|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-09 19:17:14,350|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-09 19:17:14,353|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:14,361|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:14,391|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-09 19:17:14,475|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-09 19:17:14,477|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:14,518|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:14,584|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-09 19:17:14,630|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-09 19:17:14,659|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-09 19:17:14,695|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-09 19:17:14,747|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-09 19:17:14,778|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-09 19:17:14,779|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:14,803|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-09 19:17:14,825|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-09 19:17:14,837|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-09 19:17:14,839|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-09 19:17:14,851|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-09 19:17:14,873|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-11 01:33:04,620|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:04,646|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-11 01:33:04,653|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:33:04,654|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:04,657|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:04,669|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-11 01:33:04,672|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-11 01:33:04,675|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-11 01:33:04,693|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-11 01:33:04,696|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-11 01:33:04,700|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-11 01:33:04,702|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:04,708|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:04,721|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-11 01:33:04,726|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-11 01:33:04,727|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-11 01:33:06,046|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-11 01:33:06,047|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-11 01:33:06,090|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:33:06,092|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:06,102|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:06,115|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-11 01:33:06,125|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-11 01:33:06,451|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-11 01:33:06,481|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-11 01:33:06,491|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-11 01:33:06,512|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:33:06,513|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:06,517|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-11 01:33:06,518|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-11 01:33:06,521|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:06,538|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-11 01:33:06,539|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-11 01:33:06,920|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-11 01:33:06,942|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-11 01:33:07,007|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-11 01:33:07,021|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-11 01:33:07,024|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-11 01:33:07,025|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-11 01:33:07,445|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-11 01:33:07,472|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-11 01:33:07,532|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-11 01:33:07,546|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-11 01:33:07,553|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-11 01:33:07,558|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-11 01:33:07,560|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:07,571|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:07,592|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-11 01:33:07,610|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-11 01:33:07,617|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-11 01:33:07,630|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-11 01:33:07,631|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:07,634|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:07,644|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-11 01:33:07,646|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:33:07,648|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:07,650|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:07,663|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-11 01:33:07,668|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:33:07,670|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:07,676|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:07,688|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-11 01:33:07,736|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:33:07,737|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:07,766|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:07,806|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-11 01:33:07,848|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-11 01:33:07,867|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-11 01:33:07,894|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-11 01:33:07,932|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-11 01:33:07,954|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-11 01:33:07,955|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:07,974|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-11 01:33:07,992|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-11 01:33:08,004|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:33:08,005|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:33:08,013|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-11 01:33:08,023|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-11 01:50:25,993|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-03-11 01:50:29,881|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-03-11 01:50:29,889|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-03-11 01:50:29,894|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-03-11 01:50:29,898|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-03-11 01:50:29,903|matplotlib.legend|WARNING] No handles with labels found to put in legend.
[2020-03-11 01:50:31,546|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:31,559|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-11 01:50:31,567|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:50:31,569|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:31,573|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:31,585|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-11 01:50:31,588|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-11 01:50:31,591|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-11 01:50:31,607|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-11 01:50:31,610|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-11 01:50:31,612|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-11 01:50:31,613|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:31,617|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:31,631|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-11 01:50:31,636|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-11 01:50:31,637|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-11 01:50:32,909|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-11 01:50:32,910|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-11 01:50:32,951|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:50:32,953|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:32,964|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:32,980|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-11 01:50:32,989|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-11 01:50:33,303|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-11 01:50:33,337|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-11 01:50:33,347|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-11 01:50:33,366|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:50:33,368|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:33,371|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-11 01:50:33,372|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-11 01:50:33,376|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:33,392|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-11 01:50:33,394|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-11 01:50:33,755|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-11 01:50:33,772|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-11 01:50:33,831|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-11 01:50:33,844|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-11 01:50:33,847|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-11 01:50:33,848|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-11 01:50:34,248|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-11 01:50:34,275|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-11 01:50:34,335|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-11 01:50:34,348|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-11 01:50:34,356|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-11 01:50:34,361|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-11 01:50:34,362|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:34,375|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:34,394|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-11 01:50:34,410|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-11 01:50:34,417|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-11 01:50:34,432|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-11 01:50:34,433|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:34,435|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:34,446|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-11 01:50:34,449|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:50:34,450|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:34,452|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:34,465|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-11 01:50:34,470|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:50:34,471|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:34,478|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:34,493|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-11 01:50:34,540|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:50:34,541|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:34,571|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:34,609|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-11 01:50:34,650|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-11 01:50:34,675|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-11 01:50:34,699|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-11 01:50:34,729|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-11 01:50:34,753|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-11 01:50:34,755|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:34,764|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-11 01:50:34,780|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-11 01:50:34,789|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-11 01:50:34,790|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-11 01:50:34,794|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-11 01:50:34,803|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-12 01:03:48,854|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:48,880|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-12 01:03:48,886|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 01:03:48,887|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:48,890|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:48,905|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-12 01:03:48,908|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-12 01:03:48,910|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-12 01:03:48,934|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-12 01:03:48,937|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-12 01:03:48,939|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-12 01:03:48,941|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:48,945|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:48,964|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-12 01:03:48,968|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-12 01:03:48,969|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-12 01:03:50,275|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-12 01:03:50,277|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-12 01:03:50,320|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 01:03:50,322|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:50,332|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:50,347|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-12 01:03:50,362|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-12 01:03:50,714|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-12 01:03:50,744|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-12 01:03:50,757|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-12 01:03:50,775|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 01:03:50,776|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:50,779|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-12 01:03:50,781|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-12 01:03:50,784|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:50,801|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-12 01:03:50,803|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-12 01:03:51,289|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-12 01:03:51,306|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-12 01:03:51,365|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-12 01:03:51,382|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-12 01:03:51,384|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-12 01:03:51,385|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-12 01:03:51,759|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-12 01:03:51,773|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-12 01:03:51,833|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-12 01:03:51,849|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-12 01:03:51,858|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-12 01:03:51,864|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-12 01:03:51,865|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:51,877|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:51,897|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-12 01:03:51,911|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-12 01:03:51,920|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-12 01:03:51,937|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-12 01:03:51,939|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:51,942|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:51,954|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-12 01:03:51,957|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 01:03:51,958|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:51,961|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:51,975|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-12 01:03:51,980|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 01:03:51,981|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:51,985|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:52,001|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-12 01:03:52,055|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 01:03:52,056|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:52,084|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:52,129|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-12 01:03:52,174|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-12 01:03:52,201|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-12 01:03:52,235|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-12 01:03:52,277|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-12 01:03:52,312|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-12 01:03:52,313|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:52,337|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-12 01:03:52,358|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-12 01:03:52,372|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 01:03:52,374|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 01:03:52,384|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-12 01:03:52,396|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-12 05:58:41,707|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-12 05:58:41,726|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-12 05:58:41,737|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 05:58:41,738|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 05:58:41,744|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-12 05:58:41,758|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-12 05:58:41,760|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-12 05:58:41,765|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-12 05:58:41,781|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-12 05:58:41,786|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-12 05:58:41,789|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-12 05:58:41,791|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 05:58:41,795|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-12 05:58:41,809|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-12 05:58:41,817|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-12 05:58:41,818|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-12 05:58:44,968|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-12 05:58:44,968|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-12 05:58:45,000|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 05:58:45,002|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 05:58:45,012|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-12 05:58:45,027|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-12 05:58:45,059|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-12 05:58:45,357|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-12 05:58:45,402|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-12 05:58:45,427|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-12 05:58:45,461|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-12 05:58:45,463|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-12 05:58:45,469|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.021251770980915075
[2020-03-12 05:58:45,471|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.021333333333333333
[2020-03-12 05:58:45,477|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-12 05:58:45,495|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-12 05:58:45,497|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-12 05:58:45,517|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-12 05:58:45,519|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores above 0.99 were clipped.
[2020-03-12 05:58:45,594|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-12 05:58:45,597|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

[2020-03-13 22:20:42,427|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:42,461|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-13 22:20:42,471|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-13 22:20:42,472|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:42,477|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:42,494|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-13 22:20:42,497|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-13 22:20:42,501|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-13 22:20:42,522|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-13 22:20:42,525|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-13 22:20:42,529|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-13 22:20:42,530|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:42,534|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:42,548|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-13 22:20:42,554|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-13 22:20:42,555|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-13 22:20:44,199|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-13 22:20:44,201|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-13 22:20:44,245|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-13 22:20:44,247|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:44,259|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:44,278|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-13 22:20:44,296|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-13 22:20:44,964|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-13 22:20:45,011|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-13 22:20:45,027|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-13 22:20:45,057|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-13 22:20:45,059|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:45,064|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.7168367346938775
[2020-03-13 22:20:45,064|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.717687074829932
[2020-03-13 22:20:45,064|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:45,079|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2020-03-13 22:20:45,079|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2020-03-13 22:20:45,972|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-13 22:20:45,997|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 1.0
[2020-03-13 22:20:46,064|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2020-03-13 22:20:46,080|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-13 22:20:46,084|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-13 22:20:46,085|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-13 22:20:46,641|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bytree': 1, 'gamma': 0, 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'n_estimators': 100, 'n_jobs': -1, 'nthread': None, 'objective': 'binary:logistic', 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'verbose': 0}
[2020-03-13 22:20:46,663|causallift.nodes.model_for_each|INFO] 
### Feature importances of the model trained using samples with observational Treatment: 0.0
[2020-03-13 22:20:46,724|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2020-03-13 22:20:46,743|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-13 22:20:46,751|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2020-03-13 22:20:46,756|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-13 22:20:46,758|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:46,772|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:46,792|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2020-03-13 22:20:46,807|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-13 22:20:46,815|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2020-03-13 22:20:46,829|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-13 22:20:46,830|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:46,833|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:46,846|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2020-03-13 22:20:46,848|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-13 22:20:46,849|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:46,851|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:46,868|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01]) -> [df_02]
[2020-03-13 22:20:46,875|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-13 22:20:46,877|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:46,884|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:46,907|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2020-03-13 22:20:46,981|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-13 22:20:46,983|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:47,015|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:47,090|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2020-03-13 22:20:47,145|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 0.0 by the uplift model:
[2020-03-13 22:20:47,185|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2020-03-13 22:20:47,222|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2020-03-13 22:20:47,296|causallift.nodes.model_for_each|INFO] 
### Simulated outcome of samples recommended to be treatment: 1.0 by the uplift model:
[2020-03-13 22:20:47,385|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2020-03-13 22:20:47,388|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:47,424|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2020-03-13 22:20:47,458|kedro.pipeline.node|INFO] Running node: estimate_effect([treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2020-03-13 22:20:47,479|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-13 22:20:47,481|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-13 22:20:47,502|causallift.causal_lift|INFO] 
### Treated samples without and with uplift model:
[2020-03-13 22:20:47,531|causallift.causal_lift|INFO] 
### Untreated samples without and with uplift model:
[2020-03-14 14:32:42,611|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2020-03-14 14:32:42,655|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2020-03-14 14:32:42,667|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-14 14:32:42,669|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-14 14:32:42,674|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2020-03-14 14:32:42,696|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2020-03-14 14:32:42,699|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2020-03-14 14:32:42,703|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2020-03-14 14:32:42,734|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2020-03-14 14:32:42,739|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2020-03-14 14:32:42,744|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2020-03-14 14:32:42,746|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-14 14:32:42,752|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2020-03-14 14:32:42,775|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2020-03-14 14:32:42,780|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2020-03-14 14:32:42,782|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2020-03-14 14:32:44,339|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'warm_start': False}
[2020-03-14 14:32:44,340|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2020-03-14 14:32:44,375|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-14 14:32:44,377|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-14 14:32:44,385|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2020-03-14 14:32:44,401|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2020-03-14 14:32:44,426|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2020-03-14 14:32:44,873|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2020-03-14 14:32:44,915|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2020-03-14 14:32:44,930|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2020-03-14 14:32:44,973|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2020-03-14 14:32:44,975|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2020-03-14 14:32:44,979|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.685069008782936
[2020-03-14 14:32:44,980|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.685
[2020-03-14 14:32:44,987|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2020-03-14 14:32:45,013|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2020-03-14 14:32:45,015|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2020-03-14 14:32:45,044|causallift.nodes.model_for_each|WARNING] [Warning] Propensity scores below 0.01 were clipped.
[2020-03-14 14:32:45,147|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
DataFrame.dtypes for data must be int, float or bool.
                Did not expect the data types in fields TransformedOutcome
[2020-03-14 14:32:45,151|kedro.runner.sequential_runner|WARNING] There are 3 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:

